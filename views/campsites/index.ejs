<% layout('campsites/layouts/boilerplate') %>

<div class="row row-cols-1 row-cols-lg-4 row-cols-md-2 g-4">
    <% campsites.forEach(campsite => { %>
        <div class="col">
            <a href="/campsites/<%= campsite._id %>" class="d-block text-decoration-none card border-0 p-2 p-md-0">
                <img id="rounded" class="card-img-top" src="<%= campsite.images[0].url %>" alt="..." crossorigin="anonymous">
                <div class="d-flex justify-content-between card-body px-0 py-2">
                    <div style="width: 80%;">
                        <p class="card-title mb-0"><%= campsite.location %></p>
                        <p class="card-text mb-0 fw-normal"><small class="text-body-secondary"><%= campsite.title %></small></p>
                        <p class="card-text">&#8377;<%= new Intl.NumberFormat().format(campsite.price) %> <small class="fw-light">night</small></p>
                    </div>
                    <div style="width: 20%;">
                        <%  const rating = campsite.reviews.length && (campsite.reviews.reduce((sum, review) => sum + review.rating, 0) / campsite.reviews.length).toFixed(2) %>
                        <p class="fw-normal text-end">&#9733; <%= rating ? rating : '0.0' %></p>
                    </div>
                </div>
            </a>
        </div>
    <% }) %>
</div>

<div class="<%= campsites.length !== 32 && 'd-none' %>">
    <div class="mt-3 mt-md-5 text-center fw-normal fs-5">Continue exploring amazing campsite</div>
    <div class="d-flex justify-content-center mt-3">
        <a class="expand-content fw-normal btn-style bg-dark" href="/campsites/?query=expand">Explore more</a>
    </div>
</div>

<script src="/js/scrollPosition.js"></script>